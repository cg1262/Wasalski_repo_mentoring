<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Finance Tracker Excel{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --excel-green: #107c41;
            --excel-light-green: #e2efda;
            --excel-orange: #ff6b35;
            --excel-light-orange: #fef2e2;
            --excel-red: #c5504b;
            --excel-light-red: #fce4ec;
            --excel-blue: #4472c4;
            --excel-gray: #f2f2f2;
            --excel-dark-gray: #595959;
            --excel-border: #d0d7de;
        }

        body {
            background-color: #fafbfc;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 13px;
        }

        .navbar {
            background-color: var(--excel-green) !important;
            border-bottom: 2px solid #0e6b3a;
        }

        .navbar-brand {
            font-weight: 600;
            color: white !important;
        }

        .nav-link {
            color: rgba(255,255,255,0.9) !important;
            font-weight: 500;
            transition: all 0.2s;
        }

        .nav-link:hover {
            color: white !important;
            background-color: rgba(255,255,255,0.1);
            border-radius: 4px;
        }

        /* Excel-like table styling */
        .excel-table {
            border: 1px solid var(--excel-border);
            background: white;
        }

        .excel-table th {
            background-color: var(--excel-gray);
            border: 1px solid var(--excel-border);
            font-weight: 600;
            font-size: 12px;
            padding: 4px 8px;
            text-align: center;
        }

        .excel-table td {
            border: 1px solid var(--excel-border);
            padding: 2px 6px;
            font-size: 12px;
            vertical-align: middle;
        }

        /* Excel-like category colors */
        .category-leasing {
            background-color: var(--excel-light-red);
            border-left: 4px solid var(--excel-red);
        }

        .category-zywnosc, .category-transport, .category-rozrywka, 
        .category-leki, .category-dom {
            background-color: var(--excel-light-orange);
            border-left: 4px solid var(--excel-orange);
        }

        .category-vat {
            background-color: #fff2cc;
            border-left: 4px solid #d6b656;
        }

        .category-inne {
            background-color: var(--excel-gray);
            border-left: 4px solid var(--excel-dark-gray);
        }

        /* Control panel styling */
        .control-panel {
            background: linear-gradient(135deg, var(--excel-green), #0e6b3a);
            color: white;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .control-panel .form-label {
            color: rgba(255,255,255,0.9);
            font-weight: 600;
            margin-bottom: 5px;
        }

        .control-panel .form-control {
            background-color: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            font-weight: 600;
        }

        .control-panel .form-control:focus {
            background-color: rgba(255,255,255,0.2);
            border-color: rgba(255,255,255,0.5);
            color: white;
            box-shadow: 0 0 0 0.2rem rgba(255,255,255,0.25);
        }

        .control-panel .form-control::placeholder {
            color: rgba(255,255,255,0.7);
        }

        /* Monthly overview cards */
        .month-card {
            background: white;
            border: 2px solid var(--excel-border);
            border-radius: 6px;
            margin-bottom: 15px;
            transition: all 0.2s;
        }

        .month-card:hover {
            border-color: var(--excel-blue);
            box-shadow: 0 2px 8px rgba(68, 114, 196, 0.2);
        }

        .month-card-header {
            background-color: var(--excel-blue);
            color: white;
            padding: 8px 12px;
            font-weight: 600;
            border-radius: 4px 4px 0 0;
        }

        .month-card-body {
            padding: 12px;
        }

        /* Excel-like input fields */
        .excel-input {
            border: 1px solid var(--excel-border);
            border-radius: 2px;
            padding: 4px 8px;
            font-size: 12px;
            background: white;
        }

        .excel-input:focus {
            border-color: var(--excel-blue);
            box-shadow: 0 0 0 2px rgba(68, 114, 196, 0.2);
            outline: none;
        }

        /* Summary boxes like Excel */
        .excel-summary-box {
            background: white;
            border: 2px solid var(--excel-border);
            border-radius: 4px;
            padding: 10px;
            text-align: center;
            margin-bottom: 10px;
        }

        .excel-summary-positive {
            background-color: var(--excel-light-green);
            border-color: var(--excel-green);
            color: var(--excel-green);
        }

        .excel-summary-negative {
            background-color: var(--excel-light-red);
            border-color: var(--excel-red);
            color: var(--excel-red);
        }

        .excel-summary-neutral {
            background-color: var(--excel-light-orange);
            border-color: var(--excel-orange);
            color: var(--excel-orange);
        }

        /* Dropdown menus */
        .dropdown-menu {
            border: 1px solid var(--excel-border);
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }

        .dropdown-item:hover {
            background-color: var(--excel-light-green);
            color: var(--excel-green);
        }

        /* Buttons */
        .btn-excel-primary {
            background-color: var(--excel-green);
            border-color: var(--excel-green);
            color: white;
            font-weight: 600;
        }

        .btn-excel-primary:hover {
            background-color: #0e6b3a;
            border-color: #0e6b3a;
            color: white;
        }

        .btn-excel-secondary {
            background-color: var(--excel-gray);
            border-color: var(--excel-border);
            color: var(--excel-dark-gray);
            font-weight: 600;
        }

        .btn-excel-secondary:hover {
            background-color: #e0e0e0;
            border-color: var(--excel-dark-gray);
            color: var(--excel-dark-gray);
        }

        /* Cards */
        .card {
            border: 1px solid var(--excel-border);
            border-radius: 6px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .card-header {
            background-color: var(--excel-gray);
            border-bottom: 1px solid var(--excel-border);
            font-weight: 600;
            color: var(--excel-dark-gray);
        }

        /* Excel-like number formatting */
        .excel-number {
            font-family: 'Courier New', monospace;
            text-align: right;
            font-weight: 600;
        }

        .excel-currency::after {
            content: ' zł';
            color: var(--excel-dark-gray);
            font-weight: normal;
        }

        /* Responsive adjustments */
        @media (max-width: 768px) {
            .control-panel {
                padding: 15px;
            }
            
            .excel-table {
                font-size: 11px;
            }
            
            .excel-table th,
            .excel-table td {
                padding: 2px 4px;
            }
        }

        /* Loading and status indicators */
        .status-indicator {
            display: inline-block;
            width: 10px;
            height: 10px;
            border-radius: 50%;
            margin-right: 5px;
        }

        .status-active { background-color: var(--excel-green); }
        .status-warning { background-color: var(--excel-orange); }
        .status-inactive { background-color: var(--excel-dark-gray); }

        /* Flash messages */
        .alert {
            border-radius: 4px;
            font-weight: 500;
        }

        .alert-success {
            background-color: var(--excel-light-green);
            border-color: var(--excel-green);
            color: var(--excel-green);
        }

        .alert-danger {
            background-color: var(--excel-light-red);
            border-color: var(--excel-red);
            color: var(--excel-red);
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">
                <i class="fas fa-table"></i> Finance Tracker Excel
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('index') }}">
                            <i class="fas fa-home"></i> Panel główny
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('control_panel') }}">
                            <i class="fas fa-cog"></i> Panel kontrolny
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="monthsDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-calendar"></i> Miesiące
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{{ url_for('month_detail', year=current_year, month=current_month) }}">
                                <i class="fas fa-calendar-day"></i> Bieżący miesiąc
                            </a></li>
                            <li><hr class="dropdown-divider"></li>
                            <li><h6 class="dropdown-header">{{ current_year }}</h6></li>
                            {% set month_names = ['', 'Styczeń', 'Luty', 'Marzec', 'Kwiecień', 'Maj', 'Czerwiec', 'Lipiec', 'Sierpień', 'Wrzesień', 'Październik', 'Listopad', 'Grudzień'] %}
                            {% for month in range(1, 13) %}
                                <li><a class="dropdown-item" href="{{ url_for('month_detail', year=current_year, month=month) }}">
                                    {{ month_names[month] }}
                                </a></li>
                            {% endfor %}
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('leasing') }}">
                            <i class="fas fa-credit-card"></i> Leasing
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('yearly_planned') }}">
                            <i class="fas fa-calendar-check"></i> Planowane roczne
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{{ url_for('savings') }}">
                            <i class="fas fa-piggy-bank"></i> Oszczędności
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container-fluid" style="max-width: 1400px;">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
                {% for category, message in messages %}
                    <div class="alert alert-{{ 'success' if category == 'success' else 'danger' }} alert-dismissible fade show" role="alert">
                        {{ message }}
                        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                    </div>
                {% endfor %}
            {% endif %}
        {% endwith %}

        {% block content %}{% endblock %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    
    <script>
        // Excel-like number formatting
        function formatCurrency(number) {
            return new Intl.NumberFormat('pl-PL', {
                style: 'currency',
                currency: 'PLN',
                minimumFractionDigits: 2
            }).format(number);
        }

        // Auto-save functionality for forms
        function autoSave(form) {
            const formData = new FormData(form);
            // Could implement auto-save here if needed
        }

        // Excel-like cell selection
        $(document).ready(function() {
            $('.excel-table td').click(function() {
                $('.excel-table td').removeClass('selected');
                $(this).addClass('selected');
            });

            // Format currency fields
            $('.excel-number').each(function() {
                const value = parseFloat($(this).text());
                if (!isNaN(value)) {
                    $(this).text(value.toFixed(2));
                }
            });
        });
    </script>

    {% block scripts %}{% endblock %}
</body>
</html>